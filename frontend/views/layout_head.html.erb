<%= javascript_include_tag "#{AppConfig[:frontend_proxy_prefix]}assets/reformulator.js?_t=#{ASConstants.VERSION}" %>

<script>
  // no longer waiting for document ready to be sure the handlers are in place
  // before they get triggered.
  new Reformulator(<%== ASUtils.to_json(Reformulator.configuration) %>, '<%= controller_name %>');
</script>

<script>
 var hideUnusedExtras = function (scope) {
   // Hide unused stuff
   var result = $('.dropdown-toggle.merge-action,' +
     '.btn.merge-button,' +
     '.add-event-action,' +
     '.record-toolbar .transfer-action,' +
     'button.suppress-record,' +
     'button[data-confirm-btn-label="Publish All"]', scope);
   if (result.length > 0) {
     result.remove();
   }
 };

 $(document).on('loadedrecordform.aspace', function(_, $form) { hideUnusedExtras($form) });
 $(document).on('subrecordcreated.aspace', function(_, _, $container) { hideUnusedExtras($container) });
 $(function () {
   hideUnusedExtras(document.body);
 });
</script>
